% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Faov.R
\name{Faov}
\alias{Faov}
\title{Perform a Functional ANOVA Over a Signal}
\usage{
Faov(
  dta,
  design,
  design0 = NULL,
  edesign = NULL,
  nbf = 0,
  pvalue = c("none", "Satterthwaite", "MC"),
  nsamples = 200,
  min.err = 0.01,
  verbose = FALSE,
  parallel = TRUE,
  nbcores = NULL,
  sd = FALSE
)
}
\arguments{
\item{dta}{A numeric matrix of dimension n × T, where n is the number of samples and T the number of time points.}

\item{design}{A design matrix for the full model (under H1).}

\item{design0}{An optional design matrix for the reduced model (under H0). Default is a column of ones.}

\item{edesign}{An optional contrast matrix to test specific linear hypotheses.}

\item{nbf}{An integer or vector of integers indicating the number of factors for the FA approximation.}

\item{pvalue}{Method to compute p-values. One of \code{"none"}, \code{"Satterthwaite"}, or \code{"MC"} (Monte Carlo). Default is \code{"none"}.}

\item{nsamples}{Number of Monte Carlo samples if \code{pvalue = "MC"}. Default is 200.}

\item{min.err}{Convergence threshold for the FA estimation algorithm. Default is 0.01.}

\item{verbose}{Logical. If TRUE, convergence messages are printed. Default is FALSE.}

\item{parallel}{Logical. If TRUE, computations are done in parallel. Default is TRUE.}

\item{nbcores}{Number of cores to use if \code{parallel = TRUE}. If NULL, all available cores are used.}

\item{sd}{Logical. If TRUE, residual standard deviations are returned. Default is FALSE.}
}
\value{
A list with components:
\describe{
\item{Fols}{F-statistic using ordinary least squares (OLS).}
\item{Fgls0}{F-statistic using generalized least squares (GLS) without FA modeling.}
\item{Fgls}{F-statistics using GLS with FA modeling (if \code{nbf > 0}).}
\item{F}{Pointwise OLS F-statistics (vector of length T).}
\item{wF}{Pointwise GLS F-statistics (matrix of size \code{length(nbf)} × T).}
\item{b.ols}{OLS beta coefficients.}
\item{coef}{All coefficients from OLS (including non-tested effects).}
\item{beta}{Coefficients for the tested effects only.}
\item{sdres}{Residual standard deviations (length T).}
}
}
\description{
Perform a Functional ANOVA Over a Signal
}
\examples{
# Simulated data
set.seed(123)
n <- 50  # number of subjects
T <- 100  # number of time points
x <- rnorm(n)
y <- rbinom(n, 1, 0.5)
X <- model.matrix(~ x + y)
data <- matrix(rnorm(n * T), nrow = n)

# Run FAov with no factor modeling
result <- Faov(dta = data, design = X, nbf = 0, nbcores = 2)
result$Fols  # global OLS F-statistic

}
