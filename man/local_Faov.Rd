% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/local_Faov.R
\name{local_Faov}
\alias{local_Faov}
\title{Perform Local Functional ANOVA Over a Signal}
\usage{
local_Faov(
  dta,
  design,
  design0 = NULL,
  edesign = NULL,
  nbf = 0,
  pvalue = c("none", "Satterthwaite", "MC"),
  nsamples = 200,
  min.err = 0.01,
  verbose = FALSE,
  parallel = TRUE,
  nbcores = NULL,
  window_size = round(ncol(dta)/10),
  number_intervals = round(ncol(dta)/5),
  sig.level = 0.05
)
}
\arguments{
\item{dta}{A numeric matrix of dimension \eqn{n \times T}, where each row corresponds to a subject and each column to a time point.}

\item{design}{A model matrix for the full (non-null) model (dimensions: \eqn{n \times p}).}

\item{design0}{A model matrix for the null model (dimensions: \eqn{n \times q}, with \eqn{q < p}). If \code{NULL}, defaults to an intercept-only model.}

\item{edesign}{Optional: a model matrix for an extended model (typically for testing nested model assumptions). Must have more columns than both \code{design} and \code{design0}.}

\item{nbf}{A vector of indices indicating which effects in the model correspond to the factor of interest. These indices are used for F-statistic computation.}

\item{pvalue}{Method for approximating p-values: \code{"none"}, \code{"Satterthwaite"} (default), or \code{"MC"} for Monte Carlo approximation.}

\item{nsamples}{Integer. Number of Monte Carlo samples used when computing p-values (for \code{"Satterthwaite"} or \code{"MC"} methods).}

\item{min.err}{Minimum error for iterative computations (relevant when approximating p-values).}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages during the computation.}

\item{parallel}{Logical. If \code{TRUE}, computations are parallelized over time intervals.}

\item{nbcores}{Number of CPU cores to use for parallelization. If \code{NULL}, defaults to the number of available cores minus one.}

\item{window_size}{Integer. The number of time points included in each local interval (i.e., the bandwidth).}

\item{number_intervals}{Integer. Number of intervals to test along the time axis.}

\item{sig.level}{Significance level used to determine whether a time interval is considered significant.}
}
\value{
A list with the following elements:
\describe{
\item{\code{interval_centers}}{Vector of center indices for each time interval tested.}
\item{\code{pvalues}}{Vector of p-values (one per tested interval).}
\item{\code{pvalues_agg}}{Vector of aggregated p-values from global tests after removing stepwise significant intervals.}
\item{\code{significant}}{Vector of time indices considered significant across intervals.}
\item{\code{pval_out}}{p-value of the global test excluding significant intervals.}
\item{\code{pval_in}}{p-value of the global test restricted to significant intervals.}
}
}
\description{
This function identifies localized time intervals within a multivariate signal where a functional ANOVA (fANOVA) reveals statistically significant differences between experimental conditions.
}
\details{
The function applies a sliding-window fANOVA along the time dimension of the signal to identify regions with statistically significant differences. It controls for multiple testing by performing a stepwise removal of significant regions and evaluating the global null hypothesis on the remaining signal.

The function assumes that \code{design0} is nested within \code{design}, and that if provided, \code{edesign} nests both \code{design0} and \code{design}.

Parallel computation can substantially speed up the local testing across time intervals.
}
\examples{
\dontrun{
# Simulated example with 100 subjects and 200 time points
n <- 100
T <- 200
signal <- matrix(rnorm(n * T), nrow = n)
group <- rep(1:2, each = n/2)
design <- model.matrix(~ factor(group))
res <- local_Faov(signal, design = design, pvalue = "Satterthwaite", nbcores = 2)
plot(res$interval_centers, res$pvalues, type = "b")
}

}
\seealso{
\code{\link[=Faov]{Faov()}} for the underlying fANOVA test.
}
